<div class="character-detail-container">
  @if (error()) {
    <app-error-message
      [error]="error()"
      (retry)="loadCharacter()"
      (dismiss)="errorHandler.clearError()"
    ></app-error-message>
  }

  @if (character() && !error()) {
    <mat-card class="character-card">
      <mat-card-header>
        <div class="character-header">
          <div class="character-title">
            <h1 [style.color]="getClassColor(character()!.class)">
              {{ character()!.name }}
            </h1>
            <p class="character-subtitle">
              Level {{ character()!.level }} 
              {{ character()!.class }} - 
              {{ character()!.race }}
            </p>
            <p class="character-realm">{{ character()!.realm }} ({{ character()!.region.toUpperCase() }})</p>
          </div>
        </div>
      </mat-card-header>

      <mat-divider></mat-divider>

      <mat-card-content>
        <div class="stats-grid">
          <div class="stat-item">
            <mat-icon>emoji_events</mat-icon>
            <div class="stat-content">
              <span class="stat-label">Achievement Points</span>
              <span class="stat-value">{{ character()!.achievementPoints }}</span>
            </div>
          </div>

          <div class="stat-item">
            <mat-icon>star</mat-icon>
            <div class="stat-content">
              <span class="stat-label">Item Level</span>
              <span class="stat-value">{{ character()!.averageItemLevel }}</span>
            </div>
          </div>

          <div class="stat-item">
            <mat-icon>checkroom</mat-icon>
            <div class="stat-content">
              <span class="stat-label">Equipped Item Level</span>
              <span class="stat-value">{{ character()!.equippedItemLevel }}</span>
            </div>
          </div>

          <div class="stat-item">
            <mat-icon>flag</mat-icon>
            <div class="stat-content">
              <span class="stat-label">Faction</span>
              <span class="stat-value">{{ character()!.faction }}</span>
            </div>
          </div>
        </div>

        @if (character()!.lastModified) {
          <p class="last-modified">
            Last updated: {{ character()!.lastModified | date:'medium' }}
          </p>
        }
      </mat-card-content>

      <mat-card-actions>
        <button mat-button (click)="goBack()">
          <mat-icon>arrow_back</mat-icon>
          Back to Search
        </button>
      </mat-card-actions>
    </mat-card>
  }
</div>
